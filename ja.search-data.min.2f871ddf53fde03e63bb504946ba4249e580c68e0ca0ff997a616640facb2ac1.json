[{"id":0,"href":"/docs/re/tre/install/","title":"インストール","section":"Tre","content":" 1.はじめに # 正規表現ライブラリ TRE をインストールします。公式サイトは https://laurikari.net/tre/ です。\nインストールは以下の環境で行います。\n$ lsb_release -a No LSB modules are available. Distributor ID: Ubuntu Description: Ubuntu 22.04.3 LTS Release: 22.04 Codename: jammy 2.ダウンロード # git でソースコードをダウンロードします。\n$ git clone https://github.com/laurikari/tre.git 3.インストール # 3.1 autogen.sh # TRE は以下のファイルから構成されています。\n$ cd tre/ $ ls AUTHORS NEWS TODO doc po tre.pc.in waf ChangeLog.old README.md Tools lib python tre.spec.in win32 LICENSE README_waf.txt configure.ac local_includes src utils wscript Makefile.am THANKS contrib m4 tests vcbuild autogen.sh を実行します。\n$ ./utils/autogen.sh Replacing @TRE_VERSION@ by 0.8.0 to python/setup.py Replacing @TRE_VERSION_1@ by 0 to python/setup.py Replacing @TRE_VERSION_2@ by 8 to python/setup.py Replacing @TRE_VERSION_3@ by 0 to python/setup.py Replacing @TRE_VERSION@ by 0.8.0 to win32/tre-config.h Replacing @TRE_VERSION_1@ by 0 to win32/tre-config.h Replacing @TRE_VERSION_2@ by 8 to win32/tre-config.h Replacing @TRE_VERSION_3@ by 0 to win32/tre-config.h ./utils/autogen.sh: 12: autopoint: not found autopoint がないと言われたのでインストールします。\n$ sudo apt-get install autopoint 再度スクリプトを実行します。\n$ ./utils/autogen.sh エラーが消えました。\n改めてファイル一覧を表示します。\n$ ls ABOUT-NLS Makefile.in TODO configure local_includes tests waf AUTHORS NEWS Tools configure.ac m4 tre.pc.in win32 ChangeLog.old README.md aclocal.m4 contrib po tre.spec.in wscript LICENSE README_waf.txt autom4te.cache doc python utils Makefile.am THANKS config.h.in lib src vcbuild スクリプトを実行したことによって、以下6つのファイルが生成されていることがわかります。\nABOUT-NLS Makefile.in aclocal.m4 auto4te.cache config.h.in configure 3.2 configure # 生成された configure を使います。\n$ ./configure checking build system type... x86_64-pc-linux-gnu checking host system type... x86_64-pc-linux-gnu checking target system type... x86_64-pc-linux-gnu （省略） Configuration summary ===================== TRE is now configured as follows: * Compilation environment CC = gcc CFLAGS = -g -O2 -Wall CPP = gcc -E CPPFLAGS = LD = /usr/bin/ld -m elf_x86_64 LDFLAGS = LIBS = Use alloca(): yes * TRE options Development-time debugging: no System regex ABI compatibility: no Wide character (wchar_t) support: yes Multibyte character set support: yes Approximate matching support: yes Build and install agrep: yes 以下のとおり、Makefile が生成されました。\n$ ls ABOUT-NLS Makefile.in Tools config.status libtool stamp-h1 utils AUTHORS NEWS aclocal.m4 configure local_includes tests vcbuild ChangeLog.old README.md autom4te.cache configure.ac m4 tre.pc waf LICENSE README_waf.txt config.h contrib po tre.pc.in win32 Makefile THANKS config.h.in doc python tre.spec wscript Makefile.am TODO config.log lib src tre.spec.in 3.3 make check # インストールする前にテストを通します。\n$ make check Making check in local_includes （省略） PASS: test-str-source PASS: retest FAIL: wretest ============================================================================ Testsuite summary for TRE 0.8.0 ============================================================================ # TOTAL: 3 # PASS: 2 # SKIP: 0 # XFAIL: 0 # FAIL: 1 # XPASS: 0 # ERROR: 0 ============================================================================ See tests/test-suite.log ============================================================================ （省略） 3.4 エラー解消 # README.md の記載によれば、下記のツールが必須となります。\nautoconf automake gettext libtool 筆者の環境では libtool を入れていなかったのでインストールします。\n$ libtool Command \u0026#39;libtool\u0026#39; not found, but can be installed with: sudo apt install libtool-bin $ sudo apt-get install libtool-bin make からやり直します。\n$ make clean $ make 再度テストします。\n$ make check （省略） PASS: test-str-source PASS: retest FAIL: wretest （省略） wretest で何らかのエラーが生じているようです。ログを確認します。\n$ cat tests/test-suite.log ===================================== TRE 0.8.0: tests/test-suite.log ===================================== # TOTAL: 3 # PASS: 2 # SKIP: 0 # XFAIL: 0 # FAIL: 1 # XPASS: 0 # ERROR: 0 .. contents:: :depth: 2 FAIL: wretest ============= Could not set locale en_US.ISO-8859-1. Expect some `Invalid or incomplete multi-byte sequence\u0026#39; errors. （省略） TRE_MULTIBYTE enabled, but skipping LC_CTYPE ja_JP.eucJP (locale unavailable) 3 (1 + 2) out of 49851 tests FAILED! No memory leaks. Peak memory consumption 203272 bytes (198.5 kB, 0.2 MB) in 278 blocks (average 731 bytes per block). FAIL wretest (exit status: 1) en_US.ISO-8859-1 を設定できないことでエラーが生じています。locale について確認します。\n$ locale -a C C.utf8 POSIX en_US.utf8 ja_JP.utf8 確かにこの中に en_US.ISO-8859-1 はありません。\n面倒なので一括でインストールします。\n$ sudo apt-get install locales-all エラーの原因は解消したので、改めてテストします。\n$ make check Making check in local_includes （省略） PASS: test-str-source PASS: retest PASS: wretest ============================================================================ Testsuite summary for TRE 0.8.0 ============================================================================ # TOTAL: 3 # PASS: 3 # SKIP: 0 # XFAIL: 0 # FAIL: 0 # XPASS: 0 # ERROR: 0 ============================================================================ （省略） テストが通りました。\n3.5 make install # 最後にインストールを行います。\n$ sudo make install インストール後、以下のディレクトリ配下に TRE 関連のファイルが確認できます。\n$ ls /usr/local/include/tre/ regex.h tre-config.h tre.h $ ls /usr/local/lib/libtre* /usr/local/lib/libtre.la /usr/local/lib/libtre.so.5 /usr/local/lib/libtre.so /usr/local/lib/libtre.so.5.0.0 以上で TRE のインストールが完了しました。\n4. 参考 URL # https://laurikari.net/tre/ https://github.com/laurikari/tre https://ducktape.blot.im/tre-a-regex-engine-with-approximate-matching https://en.wikipedia.org/wiki/TRE_(computing) https://askubuntu.com/questions/469325/what-is-autopoint https://lists.debian.org/debian-lts/2016/10/msg00178.html https://qiita.com/valzer0/items/d7166a27c156b0699655 "}]